# ğŸ—ï¸ Architecture Diagram

## Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE                           â”‚
â”‚                          (Streamlit)                             â”‚
â”‚                           app.py                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Sidebar    â”‚  â”‚  Main Area   â”‚  â”‚  Downloads   â”‚         â”‚
â”‚  â”‚   Inputs     â”‚  â”‚  Results     â”‚  â”‚  JSON        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CALCULATION LAYER                             â”‚
â”‚                         calc.py                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  calculate_sip() â”‚  â”‚  calculate_emi() â”‚  â”‚  format_inr()â”‚ â”‚
â”‚  â”‚  PMT Formula     â”‚  â”‚  EMI Formula     â”‚  â”‚  â‚¹ Formatter â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LANGCHAIN LLM FACTORY                           â”‚
â”‚                          llm.py                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  get_llm()                                                 â”‚ â”‚
â”‚  â”‚  â””â”€ ChatHuggingFace + HuggingFaceEndpoint                 â”‚ â”‚
â”‚  â”‚     â””â”€ Qwen 2.5-7B Instruct (free tier)                   â”‚ â”‚
â”‚  â”‚        â””â”€ Excellent Hindi support                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LANGCHAIN MULTI-AGENT SYSTEM                        â”‚
â”‚                        agents.py                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  run_multi_agent_flow() - LangChain Messages             â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  Step 1: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚          â”‚  AdvisorAgent      â”‚  à¤¸à¤²à¤¾à¤¹à¤•à¤¾à¤°                â”‚  â”‚
â”‚  â”‚          â”‚  SystemMessage +   â”‚                         â”‚  â”‚
â”‚  â”‚          â”‚  HumanMessage      â”‚                         â”‚  â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â”‚                     â”‚                                    â”‚  â”‚
â”‚  â”‚  Step 2:            â–¼                                    â”‚  â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚          â”‚  RiskAnalystAgent  â”‚  à¤œà¥‹à¤–à¤¿à¤® à¤µà¤¿à¤¶à¥à¤²à¥‡à¤·à¤•        â”‚  â”‚
â”‚  â”‚          â”‚  SystemMessage +   â”‚                         â”‚  â”‚
â”‚  â”‚          â”‚  HumanMessage      â”‚                         â”‚  â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â”‚                     â”‚                                    â”‚  â”‚
â”‚  â”‚  Step 3:            â–¼                                    â”‚  â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚          â”‚  PlannerAgent      â”‚  à¤¯à¥‹à¤œà¤¨à¤¾à¤•à¤°à¥à¤¤à¥à¤¤à¤¾          â”‚  â”‚
â”‚  â”‚          â”‚  SystemMessage +   â”‚                         â”‚  â”‚
â”‚  â”‚          â”‚  HumanMessage      â”‚                         â”‚  â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      UTILITIES LAYER                             â”‚
â”‚                         utils.py                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ save_           â”‚  â”‚ summarize_       â”‚  â”‚ load_        â”‚ â”‚
â”‚  â”‚ conversation()  â”‚  â”‚ short()          â”‚  â”‚ conversation()â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FILE SYSTEM                               â”‚
â”‚                       logs/ directory                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  finance_plan_20251130_103000.json                        â”‚ â”‚
â”‚  â”‚  finance_plan_20251130_110000.json                        â”‚ â”‚
â”‚  â”‚  finance_plan_20251130_120000.json                        â”‚ â”‚
â”‚  â”‚  ...                                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Example

```
User enters:
  Income: â‚¹50,000
  Target: â‚¹10,00,000
  Time: 5 years
  Risk: Medium
        â”‚
        â–¼
calc.calculate_sip()
  Returns: â‚¹12,244.45/month
        â”‚
        â–¼
llm.get_llm()
  Initializes: ChatHuggingFace(Qwen/Qwen2.5-7B-Instruct)
        â”‚
        â–¼
agents.run_multi_agent_flow()
  Uses: LangChain SystemMessage + HumanMessage
  â”œâ”€ AdvisorAgent.analyze()
  â”‚  Returns: "à¤†à¤ªà¤•à¥€ à¤†à¤¯ à¤•à¥‡ à¤…à¤¨à¥à¤¸à¤¾à¤°..."
  â”‚
  â”œâ”€ RiskAnalystAgent.analyze()
  â”‚  Returns: "à¤¯à¤¹ à¤¯à¥‹à¤œà¤¨à¤¾ à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤¹à¥ˆ..."
  â”‚
  â””â”€ PlannerAgent.create_plan()
     Returns: "à¤®à¤¾à¤¸à¤¿à¤• à¤¬à¤œà¤Ÿ: 50% à¤–à¤°à¥à¤š..."
        â”‚
        â–¼
utils.save_conversation()
  Saves: logs/finance_plan_20251130_103000.json
        â”‚
        â–¼
app.py displays results
  Shows: All agent outputs + download button
```

## Module Dependencies

```
app.py
  â”œâ”€â”€ imports calc.py
  â”œâ”€â”€ imports llm.py
  â”œâ”€â”€ imports agents.py
  â””â”€â”€ imports utils.py

agents.py
  â”œâ”€â”€ uses llm instance (injected)
  â””â”€â”€ imports langchain_core.messages (SystemMessage, HumanMessage)

llm.py
  â””â”€â”€ imports langchain_huggingface (ChatHuggingFace, HuggingFaceEndpoint)

calc.py
  â””â”€â”€ standalone (no internal dependencies)

utils.py
  â””â”€â”€ standalone (no internal dependencies)
```

## Import Graph

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   app.py    â”‚
                    â”‚  (main UI)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚               â”‚
           â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ calc.py  â”‚    â”‚  llm.py  â”‚    â”‚agents.py â”‚
    â”‚(formulas)â”‚    â”‚(factory) â”‚    â”‚(AI logic)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚               â”‚               â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚utils.py  â”‚
                    â”‚(helpers) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Execution Sequence

```
1. User opens browser
   â†’ Streamlit loads app.py

2. User clicks "à¤¯à¥‹à¤œà¤¨à¤¾ à¤¬à¤¨à¤¾à¤à¤‚"
   â†’ app.py collects inputs

3. Calculate SIP
   â†’ calc.calculate_sip() runs
   â†’ Returns exact numbers

4. Initialize LLM (cached)
   â†’ llm.get_llm() runs once
   â†’ Returns LLM instance

5. Run agents sequentially
   â†’ agents.run_multi_agent_flow()
   â†’ AdvisorAgent â†’ RiskAnalystAgent â†’ PlannerAgent
   â†’ Returns 3 Hindi responses

6. Display results
   â†’ app.py shows in expanders

7. Save to JSON
   â†’ utils.save_conversation()
   â†’ Creates timestamped file

8. User downloads
   â†’ JSON available for download
```

## Configuration Flow

```
Environment Variables (.env)
        â”‚
        â–¼
llm.py reads HUGGINGFACEHUB_API_TOKEN
        â”‚
        â–¼
Creates HuggingFaceEndpoint
        â”‚
        â–¼
Wraps with ChatHuggingFace (LangChain)
        â”‚
        â–¼
app.py caches it (@st.cache_resource)
        â”‚
        â–¼
Passes to agents.py
        â”‚
        â–¼
Agents build SystemMessage + HumanMessage
        â”‚
        â–¼
LLM.invoke() generates Hindi responses
```

## Error Handling Flow

```
Any Error Occurs
        â”‚
        â”œâ”€ In llm.py
        â”‚  â†’ Catches â†’ Shows token error â†’ st.stop()
        â”‚
        â”œâ”€ In agents.py
        â”‚  â†’ Catches â†’ Returns "à¤¤à¥à¤°à¥à¤Ÿà¤¿: ..." â†’ Continues
        â”‚
        â”œâ”€ In calc.py
        â”‚  â†’ Validates â†’ Returns zeros if invalid
        â”‚
        â””â”€ In utils.py
           â†’ Validates â†’ Raises clear exceptions
```

## Testing Strategy

```
Unit Tests (each module independently)
  â”‚
  â”œâ”€ calc.py
  â”‚  â””â”€ python calc.py
  â”‚
  â”œâ”€ utils.py
  â”‚  â””â”€ python utils.py
  â”‚
  â”œâ”€ llm.py (requires .env)
  â”‚  â””â”€ python llm.py
  â”‚
  â””â”€ agents.py (requires .env)
     â””â”€ python agents.py

Integration Test
  â”‚
  â””â”€ streamlit run app.py
     â””â”€ Test full workflow
```

---

**Legend:**
- ğŸ“¦ Module/File
- â†’ Data/Control Flow
- â”œâ”€ Branch/Option
- â””â”€ Final Step
- â–¼ Sequential Flow
